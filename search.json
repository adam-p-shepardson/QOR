[{"path":"https://adam-p-shepardson.github.io/QOR/articles/data-setup.html","id":"helpful-packages","dir":"Articles","previous_headings":"","what":"Helpful Packages","title":"Data Setup","text":"applications QOR method likely require data cleaning manipulation typical data frames spatial objects. list R packages likely helpful tasks, dependencies QOR package :","code":"library(tidyverse) library(dplyr) library(haven) library(sf) library(QOR)  # You would need your local path below to run the setup examples: local_path <- here::here() # replace with your local path to the QOR folder if not running from the root directory of the repo"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/data-setup.html","id":"downloading-example-files","dir":"Articles","previous_headings":"","what":"Downloading Example Files","title":"Data Setup","text":"provided example, download zipped (.zip file) versions : extracts: Anonymized 2022 voter registration extract sample (~0.05%) North Carolina zip_codes: National zip code shapefiles U.S. Census Bureau state_shape: State boundary shapefile North Carolina Geospatial Data Clearinghouse district_shapes: National school district shapefiles National Center Education Statistics (NCES) unzip files direct use tutorial. also set generous download timeout given several files quite large. Users note cleaned verison small, anonymized random sample North Carolina voter registration data included QOR package educational purposes. sample data results address cleaning example . real applications, however, users need obtain voter registration data relevant governmental unit (paid provider like L2).","code":"# Increase timeout for large files options(timeout = 1000)  # Define URLs (example: North Carolina 2022 data) extracts <- \"https://www.dropbox.com/scl/fi/epopkf7wqtgs9ymod0w3h/Example-Extracts.zip?rlkey=mfuzylz2iinljy3f5te86fc1p&st=26tify0g&dl=1\" zip_codes <- \"https://www.dropbox.com/scl/fi/sq0mudsvm1g7c9ljbiye1/ZIP_2022.zip?rlkey=v9gqxsx0b1dli7lnoi95qwlyv&st=p7lprz1m&dl=1\" state_shape <- \"https://www.dropbox.com/scl/fi/a8bn3ht1d67xd412zixf5/North_Carolina_State_Boundary.zip?rlkey=2j0at3vvts5i62trqvm4itpa5&st=0soqpq4j&dl=1\" district_shapes <- \"https://www.dropbox.com/scl/fi/eh557z55pg9051dq4mves/SCHOOL_SY2022.zip?rlkey=ds8a7pocgj7evgsmvhsn9dyow&st=tecyt8yc&dl=1\"  # Download shapefiles download.file(url = zip_codes, destfile = paste0(local_path, \"data-raw/Downloads/zip_codes_2022.zip\"), mode = \"wb\", method = \"auto\") unzip(zipfile = paste0(local_path, \"data-raw/Downloads/zip_codes_2022.zip\"), exdir = paste0(local_path, \"data-raw/Extracted\")) download.file(url = state_shape, destfile = paste0(local_path, \"data-raw/Downloads/state_shape.zip\"), mode = \"wb\", method = \"auto\") unzip(zipfile = paste0(local_path, \"data-raw/Downloads/state_shape.zip\"), exdir = paste0(local_path, \"data-raw/Extracted\")) download.file(url = district_shapes, destfile = paste0(local_path, \"data-raw/Downloads/district_shapes_2022.zip\"), mode = \"wb\", method = \"auto\") unzip(zipfile = paste0(local_path, \"data-raw/Downloads/district_shapes_2022.zip\"), exdir = paste0(local_path, \"data-raw/Extracted\"))"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/data-setup.html","id":"cleaning-addresses","dir":"Articles","previous_headings":"","what":"Cleaning Addresses","title":"Data Setup","text":"using QOR, imperative ensure input data contain minimal set string address components: street city state may find components must built sub-components (e.g., street name, street number, apartment number, etc…). , read-small random sample anonymous voters address processing. Note “ncid” field randomized correspond actual voter IDs. , can prepare addresses geocoding. example written Stata saved .dta file, though address cleaning can occur programming language. Example workflow: Load raw address data Rename address component variables standard format across data years Convert address components /subcomponents strings (e.g., string variables street, city, postalcode, state) Likely Needed: Construct full street address subcomponents extent possible given data availability Remove leading/trailing whitespace variables Make sure retain generate unique state voter (unit) id along separate variables street, city, postalcode, state","code":"# Download anonymized voter registration extracts (Taken Jan. 1, 2022) download.file(url = extracts, destfile = paste0(local_path, \"data-raw/Downloads/Extracts_2022.zip\"), mode = \"wb\", method = \"auto\") unzip(zipfile = paste0(local_path, \"data-raw/Downloads/Extracts_2022.zip\"), exdir = paste0(local_path, \"data-raw/Extracted\")) sample_2022 <- haven::read_dta(paste0(local_path, \"data-raw/Extracted/Example Extracts/VR_Snapshot_2022_ALL_Anonymized.dta\"))  # View a few raw observations print(head(sample_2022, n = 10)) #> # A tibble: 10 × 12 #>       ncid house_num half_code street_dir street_name street_type_cd #>      <dbl>     <dbl> <chr>     <chr>      <chr>       <chr>          #>  1 4425080      1717 \"\"        \"\"         GARNER      RD             #>  2 2548754      1200 \"\"        \"S\"        HOLLYBROOK  RD             #>  3 4575744       126 \"\"        \"\"         BREADNUT    DR             #>  4 5823161     15424 \"\"        \"\"         GUTHRIE     DR             #>  5 6254308       550 \"\"        \"\"         CLARK       RD             #>  6 3426091       512 \"\"        \"\"         FINDHORN    LN             #>  7 5357071       707 \"\"        \"\"         PLUMMER     DR             #>  8 1978651      1212 \"\"        \"\"         FILMORE     ST             #>  9 4491130       748 \"\"        \"\"         CAR FARM    RD             #> 10 2993188       104 \"\"        \"\"         NEEDLE PARK DR             #> # ℹ 6 more variables: street_sufx_cd <chr>, unit_designator <chr>, #> #   unit_num <chr>, res_city_desc <chr>, state_cd <chr>, zip_code <chr> ## Read in cleaned sample # We call an external Stata .do file (available on GitHub) for simplicity: library(RStata) options(\"RStata.StataPath\" = \"/usr/local/stata19/stata-se\") # Path to your Stata executable. Use console version instead of GUI (stata-se instead of xstata-se) suppressWarnings(stata(src = paste0(local_path, \"data-raw/NCAddresses.do\"), stata.version = 19.5, stata.echo = TRUE,                arguments = shQuote(local_path)))  # Note: The above line requires the RStata package (install.packages(\"RStata\")) and a local installation of Stata # If using GUI version (xstata-se), GTK warnings may appear but can be ignored if output is correct"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/data-setup.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Data Setup","text":"Different raw data structures require unique approaches produce format compatible QOR functions. However, cleaned addresses, now ready geocode data apply QOR method. addresses look similar following example input dataframe correctly prepared query(). Please see Getting Started vignette function documentation additional guidance.","code":"# Read the cleaned example addresses example <- haven::read_dta(system.file(\"example_data\", \"sample_2022_addresses.dta\", package = \"QOR\"))  # View a few cleaned addresses print(head(example, n = 10)) #> # A tibble: 10 × 5 #>    statevoterid street                city         state postalcode #>    <chr>        <chr>                 <chr>        <chr> <chr>      #>  1 4425080      1717   GARNER RD      GREENVILLE   NC    27834      #>  2 2548754      1200  S HOLLYBROOK RD WENDELL      NC    27591      #>  3 4575744      126   BREADNUT DR     SMITHFIELD   NC    27577      #>  4 5823161      15424   GUTHRIE DR    HUNTERSVILLE NC    28078      #>  5 6254308      550   CLARK RD        VANCEBORO    NC    28586      #>  6 3426091      512   FINDHORN LN     WAKE FOREST  NC    27587      #>  7 5357071      707   PLUMMER DR      GREENSBORO   NC    27410      #>  8 1978651      1212   FILMORE ST     RALEIGH      NC    27605      #>  9 4491130      748   CAR FARM RD     LINCOLNTON   NC    28092      #> 10 2993188      104   NEEDLE PARK DR  CARY         NC    27513"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/extra-notes.html","id":"computing-environments","dir":"Articles","previous_headings":"","what":"Computing Environments","title":"Extra Notes","text":"data employed paper used conda environment installed R version 4.2.0 (recent R version compatible cloud computing system lead author’s university) required dependencies simultaneously. Scripts match voters school districts originally run Linux-based machines. Please note , broadly speaking, many voter files large use cases may require significant computing power. Evaluate size data computing power available running code. Academic audiences may aware R generally manipulates objects copy--modify system requires memory often expected manipulate large objects (see Ch. 2 Wickham, 2019). work large datasets, may need increase memory available R. One (rough) rule thumb least 2x size object memory manipulate . , additionally, verified QOR package functions work newer R version (4.3.3) Linux; anticipate creators relevant dependencies continue support new R releases future, well-known packages.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/articles/extra-notes.html","id":"disclaimer","dir":"Articles","previous_headings":"","what":"Disclaimer","title":"Extra Notes","text":"using data obtained level government, please consult laws specific government(s) question ensure compliance. important understand U.S. states differ widely laws regarding use voter registration data. Users solely responsible ensuring use data complies applicable laws regulations. authors package assume liability users’ treatment data use package .","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/articles/extra-notes.html","id":"reference-list","dir":"Articles","previous_headings":"","what":"Reference List","title":"Extra Notes","text":"Text throughout website cites following external references: Cambon J., Hernangómez D., Belanger C., & Possenriede D. (2021). tidygeocoder: R package geocoding. Journal Open Source Software, 6(65), 3544, https://doi.org/10.21105/joss.03544 (R package version 1.0.6) Pebesma, E., & Bivand, R. (2023). Spatial Data Science: applications R. Chapman Hall/CRC. doi:10.1201/9780429459016, https://r-spatial.org/book/. Wickham, H. (2019). Advanced R, Second Edition. Chapman & Hall/CRC. Accessed https://adv-r.hadley.nz/","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/articles/getting-started.html","id":"load-package-and-data","dir":"Articles","previous_headings":"","what":"Load Package and Data","title":"Getting Started","text":"","code":"# You would need your local path below to run the setup examples: local_path <- here::here()  # Change this to your local path  # Packages for example library(tidyverse) library(sf) library(QOR)  # Load example voter addresses example <- haven::read_dta(system.file(\"example_data\", \"sample_2022_addresses.dta\", package = \"QOR\"))  # Load shapefiles (see Data Setup vignette for download instructions) state_shape <- read_sf(dsn = paste0(local_path, \"data-raw/Extracted/North_Carolina_State_Boundary\")) %>%   dplyr::summarize(geometry = st_union(geometry)) %>%   st_make_valid() zip_shape <- sf::read_sf(dsn = paste0(local_path, \"data-raw/Extracted/ZIP_2022\")) %>%   st_make_valid() district_shape <- sf::read_sf(dsn = paste0(local_path, \"data-raw/Extracted/SCHOOL_SY2022\")) %>%   st_make_valid()"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/getting-started.html","id":"query-geocode-addresses","dir":"Articles","previous_headings":"","what":"Query: Geocode Addresses","title":"Getting Started","text":"first step geocode unit addresses using query() function. function takes data frame addresses returns two data frames: one successfully geocoded points another addresses geocoded. can demonstrate geocoding worked plotting matched points state boundary district shapes:","code":"test_query <- query(   units = example,   unit_id = \"statevoterid\",   street = \"street\",   city = \"city\",   state = \"state\",   state_shape = state_shape,   units_per_batch = 4000, # note: up to 10,000 for Census geocoder, but connection issues can arise with large batches   method = \"census\",   sleep_time = 2,   year = 2022,   unit_zip = \"postalcode\",   max_tries = 15 ) #> Runtime: Query Full Time: 1763.157 sec elapsed  matched <- test_query[[1]]    # Successfully geocoded (use for Overlay) unmatched <- test_query[[2]]  # Failed to geocode (use for Recover) # Packages for plotting library(ggplot2) library(ggthemes)  # Filter down to just NC districts district_shape_temp <- district_shape %>% filter(STATEFP == 37) # NC is FIPS 37  # Plot geocoded points plot <- ggplot() +     geom_sf(data = state_shape, alpha = 0) +     geom_sf(data = matched, pch = \"*\", size = 3, alpha = 0.2, aes(color = \"Geocoded Voters\")) +     geom_sf(data = district_shape_temp, alpha = 0.1, color = \"darkmagenta\", size = 0.5, aes(fill = \"School Districts\")) +     scale_color_manual(values = \"black\") +     scale_fill_manual(values = \"white\") +     labs(title = paste0(as.character(2022), \" Small Sample of Geocoded Voters in North Carolina\"),          caption = \"Notes: \\nWhere district files are sourced from the U.S. Census Bureau \\nand voter information is sourced from the State of North Carolina. \\nGraph reflects successful geocoding matches from sample.\",          fill = \"\", color = \"\") +     ggthemes::theme_map() +     theme(legend.position = \"bottom\", legend.direction = \"horizontal\", plot.caption = element_text(hjust = 0),           panel.background = element_rect(fill = \"white\", color = \"white\"), plot.background = element_rect(fill = \"white\", color = \"white\"))  rm(district_shape_temp)  print(plot) # display map"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/getting-started.html","id":"overlay-match-voters-to-districts","dir":"Articles","previous_headings":"","what":"Overlay: Match Voters to Districts","title":"Getting Started","text":"second step overlay geocoded points onto district shapefiles using overlay() function. function assigns geocoded point polygon (school district) based spatial location.","code":"test_overlay <- overlay(   points = matched,   polygons = district_shape,   point_id = \"statevoterid\",   polygon_id = \"GEOID\",   used_NCES = TRUE,   FIPS_code = \"37\",   FIPS_col = \"STATEFP\" )"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/getting-started.html","id":"recover-assign-unmatched-voters","dir":"Articles","previous_headings":"","what":"Recover: Assign Unmatched Voters","title":"Getting Started","text":"final step recover unmatched units using recover() function. function uses zip code information spatial distances zip code polygon centers assign unmatched units polygons.","code":"test_recover <- recover(   units = unmatched,   polygons = district_shape,   zipcodes = zip_shape,   unit_id = \"statevoterid\",   unit_zip = \"postalcode\",   polygon_id = \"GEOID\",   zip_id = \"ZCTA5CE20\",   state_shape = state_shape,   used_NCES = TRUE,   FIPS_code = \"37\",   FIPS_col = \"STATEFP\" )  matched_byzip <- test_recover[[1]]    # Successfully matched to a district by zipcode no_zip <- test_query[[2]]  # Failed to map unit zip code to a Census-recognized zip code for that year"},{"path":"https://adam-p-shepardson.github.io/QOR/articles/getting-started.html","id":"why-does-this-work","dir":"Articles","previous_headings":"","what":"Why Does This Work?","title":"Getting Started","text":"QOR leverages fact voters, school districts, zip codes spatial entities convertable coordinate reference system (CRS). visualization shows, conceptually, three different layers. Geocoded voter points query() can overlaid onto school district polygons used overlay() identify voters live districts. unmatched voters, QOR uses zip code polygons recover() intermediary spatial unit help assign voters districts based proximity.  Note: 3D plot interactive! Feel free rotate zoom explore layers. load 70% districts zipcodes random reduce browser memory burden. Simulated “voter” points also randomly distributed without regard population densities.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/articles/state-fips.html","id":"state-fips-code-reference","dir":"Articles","previous_headings":"","what":"State FIPS Code Reference","title":"State FIPS Codes","text":"FIPS (Federal Information Processing Standards) codes necessary QOR method work using NCES shapefiles. overlay() recover() functions require state_FIPS parameter correctly filter school districts. table provides complete mapping 50 U.S. state two-letter abbreviations FIPS codes per Bureau Labor Statistics:","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Adam Shepardson. Author, maintainer. Melissa Lyon. Contributor. Beth Schueler. Contributor. Joshua Bleiberg. Contributor.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Shepardson, ., Lyon, M., Schueler, B., & Bleiberg, J. (2026). QOR: Functions Identify Can Vote School District (Version 0.9.0.0) [Computer software]. https://adam-p-shepardson.github.io/QOR","code":"@Manual{,   title = {{QOR}: Functions to Identify Who Can Vote in What School District},   author = {Adam Shepardson and Melissa Lyon and Beth Schueler and Joshua Bleiberg},   year = {2026},   note = {R package version 0.9.0.0},   url = {https://adam-p-shepardson.github.io/QOR}, }"},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"qor-functions-to-identify-who-can-vote-in-what-school-district","dir":"","previous_headings":"","what":"Functions to Identify Who Can Vote in What School District","title":"Functions to Identify Who Can Vote in What School District","text":"QOR package contains functions implementing Query, Overlay, Recover (QOR) method, links analytically useful administrative boundaries individual voter files many U.S. states produce little cost. introduced QOR paper presentation 2025 Association Education Finance Policy Conference, detail process applied examples forthcoming paper.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Functions to Identify Who Can Vote in What School District","text":"Please cite work follows: Shepardson, ., Lyon, M., Schueler, B., & Bleiberg, J. (2026). QOR: Functions Identify Can Vote School District (Version 0.9.0.0) [Computer software]. https://adam-p-shepardson.github.io/QOR","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"query-overlay-recover","dir":"","previous_headings":"","what":"Query, Overlay, Recover","title":"Functions to Identify Who Can Vote in What School District","text":"QOR set interwoven geospatial data management strategies help address longstanding challenges identifying “Votes” school board elections. process follows three simple steps: Query Leverage U.S. Census Geocoder (Geocoding sevice choice) transform addresses precise longitude/latitude coordinates. query() function wrapper around excellent tidygeocoder::geocode() (Cambon et al., 2021) tailored specific data. recommend tidygeocoder easily geocoding addresses R, provide query() way demonstrate users can adapt tidygeocoder use voter files. Overlay Superimpose school district shapefiles onto voter point geometries exploit spatial object intersections match voters districts. overlay() function takes point geometries (voter locations) polygon geometries (school district boundaries) unique identifer columns, returns dataset matches point one polygon. edge cases points fall within multiple polygons polygons, function calculates distances polygon internal points assigns points nearest polygon. Recover small portion voters located exact address match, assign nearest school district registration zipcode. recover() function takes units (zipcodes), school district polygon geometries, zipcode polygon geometries unique identifer columns. calculates distances centroids zipcode internal points school district, returns dataset matches voter nearest school district based new points.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"tldr","dir":"","previous_headings":"","what":"TL;DR","title":"Functions to Identify Who Can Vote in What School District","text":"provide template code matching voters school districts via repository welcome use modification code, proper citation. step corresponds function QOR package: query() geocoding addresses point geometries overlay() matching point geometries polygon geometries recover() assigning unmatched points polygons based zipcode centroids","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Functions to Identify Who Can Vote in What School District","text":"install QOR package, use following code R: Please note package requires several dependencies (R packages) line attempts install. However, installing sf (Pebesma & Bivand, 2023) dependency difficult MacOS Linux Windows. Mac Linux users may need follow instructions installing QOR: https://github.com/r-spatial/sf","code":"remotes::install_github(\"adam-p-shepardson/QOR\", dependencies=TRUE)"},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"minimal-data-requirements","dir":"","previous_headings":"","what":"Minimal Data Requirements","title":"Functions to Identify Who Can Vote in What School District","text":"QOR requires voter postal addresses, school district shapefiles, zipcode shapefiles, state boundary shapefile, time-varying shapes ideally obtained yearly basis. undemanding data requirements can also accommodate paid voter files (including popular products vendors L2 Catalist) provided products contain registration address information. School district shapefiles NCES Education Demographic Geographic Estimates (EDGE) program zipcode shapefiles Census TIGER/LINE database preferred use QOR. Note difficult download unzipped folders directly R, downloading .zip file versions much easier. example, possible copy link .zip folders unzip R like : Users advised exercise caution view functions’ source code substituting shapefiles. Users also advised understand limitations even NCES shapefiles, recently began update boundaries yearly (though documentation suggests still re-posted every year manner aligns Census TIGER/LINE database updates). treat NCES shapefiles best available national option school district boundaries, recognize perfect. Although QOR focuses linking voters specific school districts, also possible substitute addresses entity interest (e.g., specific schools, businesses, etc…) code. Similarly, rather matching entities school districts, QOR can facilitate placing research subjects within bounds shapefiles one hand (e.g., special administrative districts broadly-speaking). recognize external applications despite focusing attention persistent voter identification problem political research school board elections.","code":"# Download utils::download.file(url = \"YOUR URL\", destfile = \"ZIP FOLDER DESTINATION PATH\", mode = \"wb\", method = \"auto\")  # Unzip utils::unzip(zipfile = \"FILE/FOLDER PATH FROM 'destfile' ABOVE\", exdir = \"EXTRACTION PATH\")"},{"path":"https://adam-p-shepardson.github.io/QOR/index.html","id":"tutorials","dir":"","previous_headings":"","what":"Tutorials","title":"Functions to Identify Who Can Vote in What School District","text":"Guidance setting raw data use QOR available Data Setup vignette. Similaly, provide example code using three main functions Getting Started vignette. additional notes, external citations, disclaimers, please see Extra Notes page.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/overlay.html","id":null,"dir":"Reference","previous_headings":"","what":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","title":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","text":"overlay() function performs \"Overlay\" (Step 2) operation QOR Method.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/overlay.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","text":"","code":"overlay(   points = NULL,   polygons = NULL,   point_id = \"point_id\",   polygon_id = \"polygon_id\",   used_NCES = FALSE,   FIPS_code = NULL,   FIPS_col = NULL )"},{"path":"https://adam-p-shepardson.github.io/QOR/reference/overlay.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","text":"points sf object containing point geometries units (e.g., voter locations). polygons sf object containing polygon geometries (e.g., school districts). point_id Name column points sf object contains unique identifiers point (default: \"point_id\"). Preferably string. polygon_id Name column polygons sf object contains unique identifiers polygon (default: \"polygon_id\"). Preferably string. used_NCES Boolean indicating whether user input NCES school district shapefiles shapefiles state FIPS_code polygons (default: FALSE). FIPS_code State FIPS code filter NCES school district shapefiles (default: NULL, means filtering state). FIPS_col Column name dataset containing FIPS_code. Preferably character/string variable (default: NULL, means filtering state).","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/overlay.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","text":"tibble three columns: point_id (string), polygon_id (string), distance (based units CRS; points just one polygon). point_id matched one polygon_id.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/overlay.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Match Point Geometries to Polygon Geometries (e.g., Voter Locations to School Districts) — overlay","text":"function: Matches point geometries (e.g., voter locations) polygon geometries (e.g., school districts) using spatial intersections distances. Requires points polygons unique identifier column. observations unique (e.g., panel data), use one timepoint per function call (e.g., voters one year, voters next year, etc...). Returns match assigns one polygon point: polygon point , closest polygon (based internal point) point polygon. return multiple polygons per point, need modify code.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/query.html","id":null,"dir":"Reference","previous_headings":"","what":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","title":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","text":"query() function performs \"Query\" (Step 1) operation QOR Method.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/query.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","text":"","code":"query(   units = NULL,   unit_id = \"unit_id\",   street = \"street\",   city = \"city\",   state = \"state\",   state_shape = NULL,   units_per_batch = 4000,   year = NULL,   method = \"census\",   sleep_time = 2,   unit_zip = \"postalcode\",   max_tries = 15 )"},{"path":"https://adam-p-shepardson.github.io/QOR/reference/query.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","text":"units Dataframe tibble containing voter information (must unique unit_id, street, city, state columns). unit_id Name column units dataframe contains unique identifiers unit (default: \"unit_id\"). Preferably string. street Name column units dataframe contains street address (default: \"street\"). city Name column units dataframe contains city (default: \"city\"). state Name column units dataframe contains state (default: \"state\"). state_shape sf object containing shape state (used filter geocoding results state, catching errors). units_per_batch Number units geocode batch (default: 4000). Internet connectivity API limits determine possibility larger (smaller) batches. Census theoretically allows batches 10,000 addresses, found smaller batches less likely rejected API. year Year data (preferably numeric) use \"census\" method. (default: NULL, throws error). Program designed years 2007 2025 using \"census\" method. Years <= 2010 use 2010 Census database, years > 2025 use current Census database. method Geocoding method use (default: \"census\"). See methods tidygeocoder::geocode(). recommend \"census\" best cost (free) batch geocoding. may need adjust parts code select outputs using different method, methods may support batch coding use default. sleep_time Time pause batches (default: 2 seconds). Try increasing getting rate-limited geocoding service encountering connection issues. unit_zip RECOMMENDED OPTIONAL name column units dataframe contains postal code (default: \"postalcode\"). Preferably string. Output postalcode column provided, column NA provided. \"Recover\" able match unmatched units postalcode provided . max_tries Number times attempt geocoding unit call API fails (default: 15). Try increasing getting rate-limited geocoding service encountering connection issues. unit fails geocode many attempts, stored unmatched function move next unit.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/query.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","text":"list two items: (1) Tibble matched units geocoded coordinates, (2) Tibble unmatched units (geocoded).","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/query.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Geocode Unit (Voter) Addresses to Longitude/Latitude Coordinates — query","text":"function: Assigns longitude latitude coordinates units (e.g., voters) based street address, city, state. Acts wrapper around tidygeocoder::geocode(), also handling additional processing needed individual voter data preparing subsequent QOR Method steps. Note: function perform matching polygons state-level zip codes; simply geocodes addresses. Focuses Census geocoding service accessible tidygeocoder package (recommend using \"census\" method best results). need modify code use different geocoding services.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/recover.html","id":null,"dir":"Reference","previous_headings":"","what":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","title":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","text":"recover() function performs \"Recover\" (Step 3) operation QOR Method.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/recover.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","text":"","code":"recover(   units = NULL,   polygons = NULL,   zipcodes = NULL,   unit_id = \"unit_id\",   unit_zip = \"postalcode\",   polygon_id = \"polygon_id\",   zip_id = \"postalcode\",   state_shape = NULL,   used_NCES = FALSE,   FIPS_code = NULL,   FIPS_col = NULL )"},{"path":"https://adam-p-shepardson.github.io/QOR/reference/recover.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","text":"units Dataframe tibble containing unit information (must unique unit_id zipcode variable). polygons sf object containing polygon geometries (e.g., school districts). zipcodes sf object containing zipcode tabulation area geometries (ZCTAs). unit_id Name column units dataframe contains unique identifiers unit (default: \"unit_id\"). Preferably string. unit_zip Name column units dataframe contains zipcodes (default: \"postalcode\"). Preferably string. NOTE: users strongly recommended first compare unit_zip's formatting zip_id column zipcodes object. polygon_id Name column polygons sf object contains unique identifiers polygon (default: \"polygon_id\"). Preferably string. zip_id Name column zipcodes sf object contains unique identifiers zipcode (default: \"postalcode\"). Preferably string. state_shape sf object containing shape state (used filter zipcodes state). used_NCES Boolean indicating whether user input NCES school district shapefiles shapefiles state FIPS_code polygons (default: FALSE). FIPS_code State FIPS code filter NCES school district shapefiles (default: NULL, means filtering state). FIPS_col Column name polygons dataset containing FIPS_code. Preferably character/string variable (default: NULL, means filtering state).","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/recover.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","text":"list two items: (1) Tibble five columns: unit_id (string), polygon_id (string), postalcode (string), distance (numeric, meters), binary flag matched_byzip, unit_id matched one polygon_id. (2) Tibble units matched zipcode (.e., recovery possible) columns unit_id postalcode.","code":""},{"path":"https://adam-p-shepardson.github.io/QOR/reference/recover.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Recover Failed Point-to-Polygon Matches Using Zipcodes — recover","text":"function: Assigns units (e.g., voters) polygon geometries (e.g., school districts) using zipcodes spatial crosswalk. Requires units, polygons, zipcodes unique identifier column. observations unique (e.g., panel data), use one timepoint per function call (e.g., voters one year, voters next year, etc.). Returns match assigns one polygon unit: polygon whose internal point closest centroid unit's zipcode. function also returns units matched zipcode second table. Intended cases \"Query\" operation fails convert address point geometry. return multiple polygons per unit, need modify code.","code":""}]
